{"ast":null,"code":"/*\r\nimport {takeEvery, fork, put, all, call} from \"redux-saga/effects\";\r\n\r\n//Account Redux states\r\nimport {REGISTER_USER} from \"./actionTypes\";\r\nimport {registerUserSuccessful, registerUserFailed} from \"./actions\";\r\n\r\n//AUTH related methods\r\nimport {postRegister} from \"../../../helpers/fackBackend_Helper\";\r\nimport {getFirebaseBackend} from \"../../../helpers/firebase_helper\";\r\n\r\n// initialize firebase Auth\r\nconst fireBaseBackend = getFirebaseBackend();\r\n\r\n// Is user register successfull then direct plot user in redux.\r\nfunction* registerUser({payload: {user}}) {\r\n\ttry {\r\n\t\t\r\n        if(process.env.REACT_APP_DEFAULTAUTH === \"firebase\"){\r\n            const response = yield call(fireBaseBackend.registerUser, user.email, user.password);\r\n            yield put(registerUserSuccessful(response));\r\n        }\r\n        else{\r\n\t\tconst response = yield call(postRegister, \"/post-register\", user);\r\n\t\tyield put(registerUserSuccessful(response));\r\n\t\t}\r\n\t} catch (error) {\r\n\t\tyield put(registerUserFailed(error));\r\n\t}\r\n}\r\n\r\nexport function* watchUserRegister() {\r\n\tyield takeEvery(REGISTER_USER, registerUser);\r\n}\r\n\r\nfunction* accountSaga() {\r\n\tyield all([fork(watchUserRegister)]);\r\n}\r\n\r\n\r\nexport default accountSaga;\r\n*/\nimport { REGISTER_USER } from \"./actionTypes\";\nimport { registerUserSuccessful, registerUserFailed } from \"./actions\";\nimport clienteAxios from \"../../config/axios\";\n\nconst registrarUsuario = async body => {\n  try {\n    const respuesta = await clienteAxios.post(\"/api/registro\", body);\n    dispatch({\n      type: REGISTRO_EXITOSO,\n      payload: respuesta.data.token\n    }); //usuarioAutenticado();\n  } catch (error) {\n    // console.log(error.response.data.msg);\n    const alerta = {\n      message: \"Hubo un error al registrar al usuario\",\n      categoria: \"alerta-error\"\n    };\n    dispatch({\n      type: REGISTRO_ERROR,\n      payload: alerta\n    });\n  }\n}; // Retorna el usuario autenticado\n\n\nconst usuarioAutenticado = async () => {\n  const token = localStorage.getItem(\"token\");\n\n  if (token) {\n    tokenAuth(token);\n  }\n\n  try {\n    const respuesta = await clienteAxios.get(\"/api/auth-user\");\n    dispatch({\n      type: OBTENER_USUARIO,\n      payload: respuesta.data.usuario\n    });\n  } catch (error) {\n    dispatch({\n      type: LOGIN_ERROR\n    });\n  }\n};\n\nexport function* watchUserRegister() {\n  yield takeEvery(REGISTER_USER, registerUser);\n}\n\nfunction* accountSaga() {\n  yield all([fork(watchUserRegister)]);\n}\n\nexport default accountSaga;","map":{"version":3,"sources":["C:/Users/alexa/Documents/Tesis-front/StarterKit/src/store/auth/register/saga.js"],"names":["REGISTER_USER","registerUserSuccessful","registerUserFailed","clienteAxios","registrarUsuario","body","respuesta","post","dispatch","type","REGISTRO_EXITOSO","payload","data","token","error","alerta","message","categoria","REGISTRO_ERROR","usuarioAutenticado","localStorage","getItem","tokenAuth","get","OBTENER_USUARIO","usuario","LOGIN_ERROR","watchUserRegister","takeEvery","registerUser","accountSaga","all","fork"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2CA,SAAQA,aAAR,QAA4B,eAA5B;AACA,SAAQC,sBAAR,EAAgCC,kBAAhC,QAAyD,WAAzD;AACA,OAAOC,YAAP,MAAyB,oBAAzB;;AAEA,MAAMC,gBAAgB,GAAG,MAAOC,IAAP,IAAgB;AACxC,MAAI;AACH,UAAMC,SAAS,GAAG,MAAMH,YAAY,CAACI,IAAb,CAAkB,eAAlB,EAAmCF,IAAnC,CAAxB;AAEAG,IAAAA,QAAQ,CAAC;AACRC,MAAAA,IAAI,EAAEC,gBADE;AAERC,MAAAA,OAAO,EAAEL,SAAS,CAACM,IAAV,CAAeC;AAFhB,KAAD,CAAR,CAHG,CAOH;AACA,GARD,CAQE,OAAOC,KAAP,EAAc;AACf;AACA,UAAMC,MAAM,GAAG;AACdC,MAAAA,OAAO,EAAE,uCADK;AAEdC,MAAAA,SAAS,EAAE;AAFG,KAAf;AAKAT,IAAAA,QAAQ,CAAC;AACRC,MAAAA,IAAI,EAAES,cADE;AAERP,MAAAA,OAAO,EAAEI;AAFD,KAAD,CAAR;AAIA;AACD,CArBD,C,CAuBA;;;AACA,MAAMI,kBAAkB,GAAG,YAAY;AACtC,QAAMN,KAAK,GAAGO,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd;;AAEA,MAAIR,KAAJ,EAAW;AACVS,IAAAA,SAAS,CAACT,KAAD,CAAT;AACA;;AAED,MAAI;AACH,UAAMP,SAAS,GAAG,MAAMH,YAAY,CAACoB,GAAb,CAAiB,gBAAjB,CAAxB;AACAf,IAAAA,QAAQ,CAAC;AACRC,MAAAA,IAAI,EAAEe,eADE;AAERb,MAAAA,OAAO,EAAEL,SAAS,CAACM,IAAV,CAAea;AAFhB,KAAD,CAAR;AAIA,GAND,CAME,OAAOX,KAAP,EAAc;AACfN,IAAAA,QAAQ,CAAC;AACRC,MAAAA,IAAI,EAAEiB;AADE,KAAD,CAAR;AAGA;AACD,CAlBD;;AAoBA,OAAO,UAAUC,iBAAV,GAA8B;AACpC,QAAMC,SAAS,CAAC5B,aAAD,EAAgB6B,YAAhB,CAAf;AACA;;AAED,UAAUC,WAAV,GAAwB;AACvB,QAAMC,GAAG,CAAC,CAACC,IAAI,CAACL,iBAAD,CAAL,CAAD,CAAT;AACA;;AAED,eAAeG,WAAf","sourcesContent":["/*\r\nimport {takeEvery, fork, put, all, call} from \"redux-saga/effects\";\r\n\r\n//Account Redux states\r\nimport {REGISTER_USER} from \"./actionTypes\";\r\nimport {registerUserSuccessful, registerUserFailed} from \"./actions\";\r\n\r\n//AUTH related methods\r\nimport {postRegister} from \"../../../helpers/fackBackend_Helper\";\r\nimport {getFirebaseBackend} from \"../../../helpers/firebase_helper\";\r\n\r\n// initialize firebase Auth\r\nconst fireBaseBackend = getFirebaseBackend();\r\n\r\n// Is user register successfull then direct plot user in redux.\r\nfunction* registerUser({payload: {user}}) {\r\n\ttry {\r\n\t\t\r\n        if(process.env.REACT_APP_DEFAULTAUTH === \"firebase\"){\r\n            const response = yield call(fireBaseBackend.registerUser, user.email, user.password);\r\n            yield put(registerUserSuccessful(response));\r\n        }\r\n        else{\r\n\t\tconst response = yield call(postRegister, \"/post-register\", user);\r\n\t\tyield put(registerUserSuccessful(response));\r\n\t\t}\r\n\t} catch (error) {\r\n\t\tyield put(registerUserFailed(error));\r\n\t}\r\n}\r\n\r\nexport function* watchUserRegister() {\r\n\tyield takeEvery(REGISTER_USER, registerUser);\r\n}\r\n\r\nfunction* accountSaga() {\r\n\tyield all([fork(watchUserRegister)]);\r\n}\r\n\r\n\r\nexport default accountSaga;\r\n*/\r\n\r\nimport {REGISTER_USER} from \"./actionTypes\";\r\nimport {registerUserSuccessful, registerUserFailed} from \"./actions\";\r\nimport clienteAxios from \"../../config/axios\";\r\n\r\nconst registrarUsuario = async (body) => {\r\n\ttry {\r\n\t\tconst respuesta = await clienteAxios.post(\"/api/registro\", body);\r\n\r\n\t\tdispatch({\r\n\t\t\ttype: REGISTRO_EXITOSO,\r\n\t\t\tpayload: respuesta.data.token,\r\n\t\t});\r\n\t\t//usuarioAutenticado();\r\n\t} catch (error) {\r\n\t\t// console.log(error.response.data.msg);\r\n\t\tconst alerta = {\r\n\t\t\tmessage: \"Hubo un error al registrar al usuario\",\r\n\t\t\tcategoria: \"alerta-error\",\r\n\t\t};\r\n\r\n\t\tdispatch({\r\n\t\t\ttype: REGISTRO_ERROR,\r\n\t\t\tpayload: alerta,\r\n\t\t});\r\n\t}\r\n};\r\n\r\n// Retorna el usuario autenticado\r\nconst usuarioAutenticado = async () => {\r\n\tconst token = localStorage.getItem(\"token\");\r\n\r\n\tif (token) {\r\n\t\ttokenAuth(token);\r\n\t}\r\n\r\n\ttry {\r\n\t\tconst respuesta = await clienteAxios.get(\"/api/auth-user\");\r\n\t\tdispatch({\r\n\t\t\ttype: OBTENER_USUARIO,\r\n\t\t\tpayload: respuesta.data.usuario,\r\n\t\t});\r\n\t} catch (error) {\r\n\t\tdispatch({\r\n\t\t\ttype: LOGIN_ERROR,\r\n\t\t});\r\n\t}\r\n};\r\n\r\nexport function* watchUserRegister() {\r\n\tyield takeEvery(REGISTER_USER, registerUser);\r\n}\r\n\r\nfunction* accountSaga() {\r\n\tyield all([fork(watchUserRegister)]);\r\n}\r\n\r\nexport default accountSaga;\r\n"]},"metadata":{},"sourceType":"module"}