{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\alexa\\\\Documents\\\\Tesis-front\\\\StarterKit\\\\src\\\\context\\\\autenticacion\\\\authState.js\";\nimport React, { useReducer } from \"react\";\nimport AuthContext from \"./authContext\";\nimport AuthReducer from \"./authReducer\";\nimport clienteAxios from \"../../config/axios\";\nimport tokenAuth from \"../../config/token\";\nimport { REGISTRO_EXITOSO, REGISTRO_ERROR, OBTENER_USUARIO, LOGIN_EXITOSO, LOGIN_ERROR, CERRAR_SESION } from \"../../types\";\n\nconst AuthState = props => {\n  const initialState = {\n    token: localStorage.getItem(\"token\"),\n    autenticado: null,\n    usuario: null,\n    mensaje: null,\n    cargando: true\n  };\n  const [state, dispatch] = useReducer(AuthReducer, initialState);\n\n  const registrarUsuario = async body => {\n    try {\n      const respuesta = await clienteAxios.post(\"/api/register\", body);\n      dispatch({\n        type: REGISTRO_EXITOSO,\n        payload: respuesta.data.token\n      });\n      usuarioAutenticado();\n    } catch (error) {// console.log(error.response.data.msg);\n    }\n  }; // Retorna el usuario autenticado\n\n\n  const usuarioAutenticado = async () => {\n    const token = localStorage.getItem(\"token\");\n\n    if (token) {\n      tokenAuth(token);\n    }\n\n    try {\n      const respuesta = await clienteAxios.get(\"/api/auth-user\");\n      dispatch({\n        type: OBTENER_USUARIO,\n        payload: respuesta.data.usuario\n      });\n    } catch (error) {\n      dispatch({\n        type: LOGIN_ERROR\n      });\n    }\n  }; // Cuando el usuario inicia sesi贸n\n\n\n  const iniciarSesion = async datos => {\n    let payload = datos;\n    payload.gethash = true;\n\n    try {\n      const respuesta = await clienteAxios.post(\"/api/login\", payload);\n      console.log(respuesta);\n      dispatch({\n        type: LOGIN_EXITOSO,\n        payload: respuesta.data.token\n      });\n      usuarioAutenticado();\n    } catch (error) {}\n  }; //Cerrar sesion del usuario\n  // Cierra la sesi贸n del usuario\n\n\n  const cerrarSesion = () => {\n    dispatch({\n      type: CERRAR_SESION\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(AuthContext.Provider, {\n    value: {\n      token: state.token,\n      autenticado: state.autenticado,\n      usuario: state.usuario,\n      mensaje: state.mensaje,\n      cargando: state.cargando,\n      registrarUsuario,\n      iniciarSesion,\n      usuarioAutenticado,\n      cerrarSesion\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 3\n    }\n  }, props.children);\n};\n\nexport default AuthState;","map":{"version":3,"sources":["C:/Users/alexa/Documents/Tesis-front/StarterKit/src/context/autenticacion/authState.js"],"names":["React","useReducer","AuthContext","AuthReducer","clienteAxios","tokenAuth","REGISTRO_EXITOSO","REGISTRO_ERROR","OBTENER_USUARIO","LOGIN_EXITOSO","LOGIN_ERROR","CERRAR_SESION","AuthState","props","initialState","token","localStorage","getItem","autenticado","usuario","mensaje","cargando","state","dispatch","registrarUsuario","body","respuesta","post","type","payload","data","usuarioAutenticado","error","get","iniciarSesion","datos","gethash","console","log","cerrarSesion","children"],"mappings":"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","sourcesContent":["import React, {useReducer} from \"react\";\r\nimport AuthContext from \"./authContext\";\r\nimport AuthReducer from \"./authReducer\";\r\n\r\nimport clienteAxios from \"../../config/axios\";\r\nimport tokenAuth from \"../../config/token\";\r\n\r\nimport {\r\n\tREGISTRO_EXITOSO,\r\n\tREGISTRO_ERROR,\r\n\tOBTENER_USUARIO,\r\n\tLOGIN_EXITOSO,\r\n\tLOGIN_ERROR,\r\n\tCERRAR_SESION,\r\n} from \"../../types\";\r\n\r\nconst AuthState = (props) => {\r\n\tconst initialState = {\r\n\t\ttoken: localStorage.getItem(\"token\"),\r\n\t\tautenticado: null,\r\n\t\tusuario: null,\r\n\t\tmensaje: null,\r\n\t\tcargando: true,\r\n\t};\r\n\r\n\tconst [state, dispatch] = useReducer(AuthReducer, initialState);\r\n\r\n\tconst registrarUsuario = async (body) => {\r\n\t\ttry {\r\n\t\t\tconst respuesta = await clienteAxios.post(\"/api/register\", body);\r\n\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: REGISTRO_EXITOSO,\r\n\t\t\t\tpayload: respuesta.data.token,\r\n\t\t\t});\r\n\t\t\tusuarioAutenticado();\r\n\t\t} catch (error) {\r\n\t\t\t// console.log(error.response.data.msg);\r\n\t\t}\r\n\t};\r\n\r\n\t// Retorna el usuario autenticado\r\n\tconst usuarioAutenticado = async () => {\r\n\t\tconst token = localStorage.getItem(\"token\");\r\n\r\n\t\tif (token) {\r\n\t\t\ttokenAuth(token);\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst respuesta = await clienteAxios.get(\"/api/auth-user\");\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: OBTENER_USUARIO,\r\n\t\t\t\tpayload: respuesta.data.usuario,\r\n\t\t\t});\r\n\t\t} catch (error) {\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: LOGIN_ERROR,\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\t// Cuando el usuario inicia sesi贸n\r\n\tconst iniciarSesion = async (datos) => {\r\n\t\tlet payload = datos;\r\n\t\tpayload.gethash = true;\r\n\t\ttry {\r\n\t\t\tconst respuesta = await clienteAxios.post(\"/api/login\", payload);\r\n\t\t\tconsole.log(respuesta);\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: LOGIN_EXITOSO,\r\n\t\t\t\tpayload: respuesta.data.token,\r\n\t\t\t});\r\n\t\t\tusuarioAutenticado();\r\n\t\t} catch (error) {\r\n\t\t}\r\n\t};\r\n\r\n\t//Cerrar sesion del usuario\r\n\t// Cierra la sesi贸n del usuario\r\n\tconst cerrarSesion = () => {\r\n\t\tdispatch({\r\n\t\t\ttype: CERRAR_SESION,\r\n\t\t});\r\n\t};\r\n\r\n\treturn (\r\n\t\t<AuthContext.Provider\r\n\t\t\tvalue={{\r\n\t\t\t\ttoken: state.token,\r\n\t\t\t\tautenticado: state.autenticado,\r\n\t\t\t\tusuario: state.usuario,\r\n\t\t\t\tmensaje: state.mensaje,\r\n\t\t\t\tcargando: state.cargando,\r\n\t\t\t\tregistrarUsuario,\r\n\t\t\t\tiniciarSesion,\r\n\t\t\t\tusuarioAutenticado,\r\n\t\t\t\tcerrarSesion,\r\n\t\t\t}}>\r\n\t\t\t{props.children}\r\n\t\t</AuthContext.Provider>\r\n\t);\r\n};\r\nexport default AuthState;\r\n"]},"metadata":{},"sourceType":"module"}