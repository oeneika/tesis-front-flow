{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\alexa\\\\Documents\\\\Tesis-front\\\\StarterKit\\\\src\\\\context\\\\autenticacion\\\\authState.js\";\nimport React, { useReducer, useState } from \"react\";\nimport AuthContext from \"./authContext\";\nimport AuthReducer from \"./authReducer\";\nimport clienteAxios from \"../../config/axios\";\nimport tokenAuth from \"../../config/token\";\nimport { REGISTRO_EXITOSO, ACTUALIZAR_USUARIO, OBTENER_USUARIO, LOGIN_EXITOSO, LOGIN_ERROR, CERRAR_SESION, AGREGAR_FOTO } from \"../../types\";\n\nconst AuthState = props => {\n  const initialState = {\n    token: localStorage.getItem(\"token\"),\n    autenticado: null,\n    usuario: null,\n    mensaje: null,\n    cargando: true\n  };\n  const [id, setId] = useState(\"\");\n  const [state, dispatch] = useReducer(AuthReducer, initialState);\n\n  const registrarUsuario = async body => {\n    console.log(body);\n\n    try {\n      const respuesta = await clienteAxios.post(\"/api/register\", body);\n      dispatch({\n        type: REGISTRO_EXITOSO,\n        payload: respuesta.data.token\n      });\n      setId(respuesta.data.id);\n      usuarioAutenticado();\n    } catch (error) {// console.log(error.response.data.msg);\n    }\n  }; // Retorna el usuario autenticado\n\n\n  const usuarioAutenticado = async () => {\n    const token = localStorage.getItem(\"token\");\n\n    if (token) {\n      tokenAuth(token);\n    }\n\n    try {\n      const respuesta = await clienteAxios.get(\"/api/auth-user\");\n      dispatch({\n        type: OBTENER_USUARIO,\n        payload: respuesta.data.user\n      });\n    } catch (error) {\n      dispatch({\n        type: LOGIN_ERROR\n      });\n    }\n  }; // Edita o modifica una tarea\n\n\n  const actualizarUsuario = async (user, id) => {\n    try {\n      const resultado = await clienteAxios.put(`/api/update-user/${id}`, user);\n      console.log(resultado);\n      agregarFoto(user);\n      dispatch({\n        type: ACTUALIZAR_USUARIO,\n        payload: resultado.data\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  }; // Cuando el usuario inicia sesión\n\n\n  const iniciarSesion = async datos => {\n    let payload = datos;\n    payload.gethash = true;\n\n    try {\n      const respuesta = await clienteAxios.post(\"/api/login\", payload);\n      setId(respuesta.data.id);\n      dispatch({\n        type: LOGIN_EXITOSO,\n        payload: respuesta.data.token\n      });\n      usuarioAutenticado();\n    } catch (error) {}\n  }; //Cerrar sesion del usuario\n  // Cierra la sesión del usuario\n\n\n  const cerrarSesion = () => {\n    dispatch({\n      type: CERRAR_SESION\n    });\n  };\n\n  const agregarFoto = async face => {\n    try {\n      console.log(face);\n      const resultado = await clienteAxios.post(`/api/upload-image-user/${face.id}`, face.image);\n      console.log(resultado); // Insertar el faces en el state\n\n      dispatch({\n        type: AGREGAR_FOTO,\n        payload: resultado.data\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(AuthContext.Provider, {\n    value: {\n      token: state.token,\n      autenticado: state.autenticado,\n      usuario: state.usuario,\n      mensaje: state.mensaje,\n      cargando: state.cargando,\n      registrarUsuario,\n      iniciarSesion,\n      usuarioAutenticado,\n      agregarFoto,\n      cerrarSesion,\n      actualizarUsuario\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 3\n    }\n  }, props.children);\n};\n\nexport default AuthState;","map":{"version":3,"sources":["C:/Users/alexa/Documents/Tesis-front/StarterKit/src/context/autenticacion/authState.js"],"names":["React","useReducer","useState","AuthContext","AuthReducer","clienteAxios","tokenAuth","REGISTRO_EXITOSO","ACTUALIZAR_USUARIO","OBTENER_USUARIO","LOGIN_EXITOSO","LOGIN_ERROR","CERRAR_SESION","AGREGAR_FOTO","AuthState","props","initialState","token","localStorage","getItem","autenticado","usuario","mensaje","cargando","id","setId","state","dispatch","registrarUsuario","body","console","log","respuesta","post","type","payload","data","usuarioAutenticado","error","get","user","actualizarUsuario","resultado","put","agregarFoto","iniciarSesion","datos","gethash","cerrarSesion","face","image","children"],"mappings":"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","sourcesContent":["import React, {useReducer, useState} from \"react\";\r\nimport AuthContext from \"./authContext\";\r\nimport AuthReducer from \"./authReducer\";\r\n\r\nimport clienteAxios from \"../../config/axios\";\r\nimport tokenAuth from \"../../config/token\";\r\n\r\nimport {\r\n\tREGISTRO_EXITOSO,\r\n\tACTUALIZAR_USUARIO,\r\n\tOBTENER_USUARIO,\r\n\tLOGIN_EXITOSO,\r\n\tLOGIN_ERROR,\r\n\tCERRAR_SESION,\r\n\tAGREGAR_FOTO,\r\n} from \"../../types\";\r\n\r\nconst AuthState = (props) => {\r\n\tconst initialState = {\r\n\t\ttoken: localStorage.getItem(\"token\"),\r\n\t\tautenticado: null,\r\n\t\tusuario: null,\r\n\t\tmensaje: null,\r\n\t\tcargando: true,\r\n\t};\r\n\r\n\tconst [id, setId] = useState(\"\");\r\n\r\n\tconst [state, dispatch] = useReducer(AuthReducer, initialState);\r\n\r\n\tconst registrarUsuario = async (body) => {\r\n\t\tconsole.log(body);\r\n\t\ttry {\r\n\t\t\tconst respuesta = await clienteAxios.post(\"/api/register\", body);\r\n\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: REGISTRO_EXITOSO,\r\n\t\t\t\tpayload: respuesta.data.token,\r\n\t\t\t});\r\n\t\t\tsetId(respuesta.data.id);\r\n\t\t\tusuarioAutenticado();\r\n\t\t} catch (error) {\r\n\t\t\t// console.log(error.response.data.msg);\r\n\t\t}\r\n\t};\r\n\r\n\t// Retorna el usuario autenticado\r\n\tconst usuarioAutenticado = async () => {\r\n\t\tconst token = localStorage.getItem(\"token\");\r\n\r\n\t\tif (token) {\r\n\t\t\ttokenAuth(token);\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst respuesta = await clienteAxios.get(\"/api/auth-user\");\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: OBTENER_USUARIO,\r\n\t\t\t\tpayload: respuesta.data.user,\r\n\t\t\t});\r\n\t\t} catch (error) {\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: LOGIN_ERROR,\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\t// Edita o modifica una tarea\r\n\tconst actualizarUsuario = async (user, id) => {\r\n\t\ttry {\r\n\t\t\tconst resultado = await clienteAxios.put(`/api/update-user/${id}`, user);\r\n\t\t\tconsole.log(resultado);\r\n\t\t\tagregarFoto(user);\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: ACTUALIZAR_USUARIO,\r\n\t\t\t\tpayload: resultado.data,\r\n\t\t\t});\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error);\r\n\t\t}\r\n\t};\r\n\r\n\t// Cuando el usuario inicia sesión\r\n\tconst iniciarSesion = async (datos) => {\r\n\t\tlet payload = datos;\r\n\t\tpayload.gethash = true;\r\n\t\ttry {\r\n\t\t\tconst respuesta = await clienteAxios.post(\"/api/login\", payload);\r\n\t\t\tsetId(respuesta.data.id);\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: LOGIN_EXITOSO,\r\n\t\t\t\tpayload: respuesta.data.token,\r\n\t\t\t});\r\n\t\t\tusuarioAutenticado();\r\n\t\t} catch (error) {}\r\n\t};\r\n\r\n\t//Cerrar sesion del usuario\r\n\t// Cierra la sesión del usuario\r\n\tconst cerrarSesion = () => {\r\n\t\tdispatch({\r\n\t\t\ttype: CERRAR_SESION,\r\n\t\t});\r\n\t};\r\n\r\n\tconst agregarFoto = async (face) => {\r\n\t\ttry {\r\n\t\t\tconsole.log(face);\r\n\t\t\tconst resultado = await clienteAxios.post(\r\n\t\t\t\t`/api/upload-image-user/${face.id}`,\r\n\t\t\t\tface.image\r\n\t\t\t);\r\n\t\t\tconsole.log(resultado);\r\n\t\t\t// Insertar el faces en el state\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: AGREGAR_FOTO,\r\n\t\t\t\tpayload: resultado.data,\r\n\t\t\t});\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error);\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<AuthContext.Provider\r\n\t\t\tvalue={{\r\n\t\t\t\ttoken: state.token,\r\n\t\t\t\tautenticado: state.autenticado,\r\n\t\t\t\tusuario: state.usuario,\r\n\t\t\t\tmensaje: state.mensaje,\r\n\t\t\t\tcargando: state.cargando,\r\n\t\t\t\tregistrarUsuario,\r\n\t\t\t\tiniciarSesion,\r\n\t\t\t\tusuarioAutenticado,\r\n\t\t\t\tagregarFoto,\r\n\t\t\t\tcerrarSesion,\r\n\t\t\t\tactualizarUsuario,\r\n\t\t\t}}>\r\n\t\t\t{props.children}\r\n\t\t</AuthContext.Provider>\r\n\t);\r\n};\r\nexport default AuthState;\r\n"]},"metadata":{},"sourceType":"module"}