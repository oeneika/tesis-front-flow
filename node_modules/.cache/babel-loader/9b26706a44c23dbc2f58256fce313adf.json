{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\alexa\\\\Documents\\\\Tesis-front\\\\StarterKit\\\\src\\\\pages\\\\Camera\\\\index.js\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport * as faceApi from \"face-api.js\";\nimport \"./styles.css\";\nconst expressionMap = {\n  neutral: \"ðŸ˜¶\",\n  happy: \"ðŸ˜„\",\n  sad: \"ðŸ˜ž\",\n  angry: \"ðŸ¤¬\",\n  fearful: \"ðŸ˜–\",\n  disgusted: \"ðŸ¤¢\",\n  surprised: \"ðŸ˜²\"\n};\nexport default class Camera extends React.Component {\n  constructor(..._args) {\n    super(..._args);\n    this.video = React.createRef();\n    this.state = {\n      expressions: []\n    };\n\n    this.log = (...args) => {\n      console.log(...args);\n    };\n\n    this.run = async () => {\n      this.log(\"run started\");\n\n      try {\n        await faceApi.nets.tinyFaceDetector.load(\"/models/\");\n        await faceApi.loadFaceExpressionModel(`/models/`);\n        this.mediaStream = await navigator.mediaDevices.getUserMedia({\n          video: {\n            facingMode: \"user\"\n          }\n        });\n        this.video.current.srcObject = this.mediaStream;\n      } catch (e) {\n        this.log(e.name, e.message, e.stack);\n      }\n    };\n\n    this.onPlay = async () => {\n      if (this.video.current.paused || this.video.current.ended || !faceApi.nets.tinyFaceDetector.params) {\n        setTimeout(() => this.onPlay());\n        return;\n      }\n\n      const options = new faceApi.TinyFaceDetectorOptions({\n        inputSize: 512,\n        scoreThreshold: 0.5\n      });\n      const result = await faceApi.detectSingleFace(this.video.current, options).withFaceExpressions();\n\n      if (result) {\n        this.log(result);\n        const expressions = result.expressions.reduce((acc, {\n          expression,\n          probability\n        }) => {\n          acc.push([expressionMap[expression], probability]);\n          return acc;\n        }, []);\n        this.log(expressions);\n        this.setState(() => ({\n          expressions\n        }));\n      }\n\n      setTimeout(() => this.onPlay(), 1000);\n    };\n  }\n\n  componentDidMount() {\n    this.run();\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 5\n      }\n    }, \"Face Recognition Webcam\"), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 5\n      }\n    }, this.state.expressions.sort((a, b) => b[1] - a[1]).filter((_, i) => i < 3).map(([e, w]) => /*#__PURE__*/React.createElement(\"p\", {\n      key: e + w,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 8\n      }\n    }, e, \" \", w))), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        width: \"100%\",\n        height: \"100vh\",\n        position: \"relative\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"video\", {\n      ref: this.video,\n      autoPlay: true,\n      muted: true,\n      onPlay: this.onPlay,\n      style: {\n        position: \"absolute\",\n        width: \"100%\",\n        height: \"100vh\",\n        left: 0,\n        right: 0,\n        bottom: 0,\n        top: 0\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 6\n      }\n    })));\n  }\n\n}\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render( /*#__PURE__*/React.createElement(App, {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 117,\n    columnNumber: 17\n  }\n}), rootElement);","map":{"version":3,"sources":["C:/Users/alexa/Documents/Tesis-front/StarterKit/src/pages/Camera/index.js"],"names":["React","ReactDOM","faceApi","expressionMap","neutral","happy","sad","angry","fearful","disgusted","surprised","Camera","Component","video","createRef","state","expressions","log","args","console","run","nets","tinyFaceDetector","load","loadFaceExpressionModel","mediaStream","navigator","mediaDevices","getUserMedia","facingMode","current","srcObject","e","name","message","stack","onPlay","paused","ended","params","setTimeout","options","TinyFaceDetectorOptions","inputSize","scoreThreshold","result","detectSingleFace","withFaceExpressions","reduce","acc","expression","probability","push","setState","componentDidMount","render","sort","a","b","filter","_","i","map","w","width","height","position","left","right","bottom","top","rootElement","document","getElementById"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport * as faceApi from \"face-api.js\";\r\n\r\nimport \"./styles.css\";\r\n\r\nconst expressionMap = {\r\n\tneutral: \"ðŸ˜¶\",\r\n\thappy: \"ðŸ˜„\",\r\n\tsad: \"ðŸ˜ž\",\r\n\tangry: \"ðŸ¤¬\",\r\n\tfearful: \"ðŸ˜–\",\r\n\tdisgusted: \"ðŸ¤¢\",\r\n\tsurprised: \"ðŸ˜²\",\r\n};\r\n\r\nexport default class Camera extends React.Component {\r\n\tvideo = React.createRef();\r\n\r\n\tstate = {expressions: []};\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.run();\r\n\t}\r\n\r\n\tlog = (...args) => {\r\n\t\tconsole.log(...args);\r\n\t};\r\n\r\n\trun = async () => {\r\n\t\tthis.log(\"run started\");\r\n\t\ttry {\r\n\t\t\tawait faceApi.nets.tinyFaceDetector.load(\"/models/\");\r\n\t\t\tawait faceApi.loadFaceExpressionModel(`/models/`);\r\n\t\t\tthis.mediaStream = await navigator.mediaDevices.getUserMedia({\r\n\t\t\t\tvideo: {facingMode: \"user\"},\r\n\t\t\t});\r\n\r\n\t\t\tthis.video.current.srcObject = this.mediaStream;\r\n\t\t} catch (e) {\r\n\t\t\tthis.log(e.name, e.message, e.stack);\r\n\t\t}\r\n\t};\r\n\r\n\tonPlay = async () => {\r\n\t\tif (\r\n\t\t\tthis.video.current.paused ||\r\n\t\t\tthis.video.current.ended ||\r\n\t\t\t!faceApi.nets.tinyFaceDetector.params\r\n\t\t) {\r\n\t\t\tsetTimeout(() => this.onPlay());\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst options = new faceApi.TinyFaceDetectorOptions({\r\n\t\t\tinputSize: 512,\r\n\t\t\tscoreThreshold: 0.5,\r\n\t\t});\r\n\r\n\t\tconst result = await faceApi\r\n\t\t\t.detectSingleFace(this.video.current, options)\r\n\t\t\t.withFaceExpressions();\r\n\r\n\t\tif (result) {\r\n\t\t\tthis.log(result);\r\n\t\t\tconst expressions = result.expressions.reduce(\r\n\t\t\t\t(acc, {expression, probability}) => {\r\n\t\t\t\t\tacc.push([expressionMap[expression], probability]);\r\n\t\t\t\t\treturn acc;\r\n\t\t\t\t},\r\n\t\t\t\t[]\r\n\t\t\t);\r\n\t\t\tthis.log(expressions);\r\n\t\t\tthis.setState(() => ({expressions}));\r\n\t\t}\r\n\r\n\t\tsetTimeout(() => this.onPlay(), 1000);\r\n\t};\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className=\"App\">\r\n\t\t\t\t<h1>Face Recognition Webcam</h1>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t{this.state.expressions\r\n\t\t\t\t\t\t.sort((a, b) => b[1] - a[1])\r\n\t\t\t\t\t\t.filter((_, i) => i < 3)\r\n\t\t\t\t\t\t.map(([e, w]) => (\r\n\t\t\t\t\t\t\t<p key={e + w}>\r\n\t\t\t\t\t\t\t\t{e} {w}\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div style={{width: \"100%\", height: \"100vh\", position: \"relative\"}}>\r\n\t\t\t\t\t<video\r\n\t\t\t\t\t\tref={this.video}\r\n\t\t\t\t\t\tautoPlay\r\n\t\t\t\t\t\tmuted\r\n\t\t\t\t\t\tonPlay={this.onPlay}\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tposition: \"absolute\",\r\n\t\t\t\t\t\t\twidth: \"100%\",\r\n\t\t\t\t\t\t\theight: \"100vh\",\r\n\t\t\t\t\t\t\tleft: 0,\r\n\t\t\t\t\t\t\tright: 0,\r\n\t\t\t\t\t\t\tbottom: 0,\r\n\t\t\t\t\t\t\ttop: 0,\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst rootElement = document.getElementById(\"root\");\r\nReactDOM.render(<App />, rootElement);\r\n"]},"metadata":{},"sourceType":"module"}